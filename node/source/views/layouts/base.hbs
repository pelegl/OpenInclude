<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="keywords" content="Open Include" />
  <meta name="description" content="Open Include" />
  <title>{{title}} - Open Include</title>
  {{> css}}  
  {{> scripts}}
</head>
<body>
	{{> header}}
	<span id='view-wrapper'>
		<section class="contents">		
		    {{{body}}}	    
	    </section>
    </span>
    {{> footer}}
    
      
  <a href="#shareYourThoughts" role="button" class="share-ideas" data-toggle="modal">Share your ideas</a>
  <!-- Modal -->
  <div id="shareYourThoughts" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3 id="myModalLabel">Share your ideas</h3>
    </div>
    <form action="/share-idea" method="POST" class='form-horizontal' style='margin:0'>    
      <div class="modal-body">        
            <div class='control-group'>
              <label class='control-label' for='email'>Email</label>
              <div class='controls'>
                <input type="text" name="email" id='email' />
              </div> 
            </div>
            <div class='control-group'>
              <label class='control-label'>Ideas</label>
              <div class='controls' for='ideas'>
                <textarea id='ideas' name="ideas" rows="5" resize='none'></textarea>
              </div> 
            </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="submit btn btn-primary">Share</button>
      </div>
    </form>    
  </div>

<script type="text/javascript">
  $('.submit').click(function() {
    $email = $('#email');
    $ideas = $('#ideas');
    $this = $(this);

    $this.addClass('disabled');
    $this.html('<img src="{{STATIC_URL}}images/loader.gif" alt="Loading..." class="loader" />');

    $.post('/share-idea',
        {email: $email.val(), ideas: $ideas.val()},
        function(data) {
          if (data.status == 'success') {
            $this.html('Success');
          } else {
            $this.html('Error occured');
          }
          setTimeout(function() {
            $('#myModal').modal('hide');
            setTimeout(function() {
              $this.removeClass('disabled').html('Submit');
              $email.val('');
              $ideas.val('');
            }, 500);
          }, 1000);
        }
    );
  });
</script>

</body>
</html>
